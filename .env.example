# Database
DATABASE_URL="postgresql://oakcloud:oakcloud_password@localhost:5432/oakcloud?schema=public"

# Auth
JWT_SECRET="your-super-secret-jwt-key-change-in-production"
JWT_EXPIRES_IN="7d"

# AI Providers (for BizFile extraction and other AI features)
# Configure at least one of these to enable AI-powered features
# OpenAI (GPT models)
OPENAI_API_KEY="sk-your-openai-api-key"
# Anthropic (Claude models)
ANTHROPIC_API_KEY="sk-ant-your-anthropic-api-key"
# Google (Gemini models)
GOOGLE_AI_API_KEY="your-google-ai-api-key"

# Default AI Model (optional - defaults to gpt-5 if not set)
# Available models: gpt-5, gpt-4.1, claude-opus-4.5, claude-sonnet-4.5, gemini-3, gemini-2.5-flash
DEFAULT_AI_MODEL="gpt-5"

# App
NEXT_PUBLIC_APP_URL="http://localhost:3000"
NODE_ENV="development"

# Logging
# Log levels (in order of verbosity): silent, error, warn, info, debug, trace
# - silent: No logging
# - error: Only errors
# - warn: Errors + warnings
# - info: Errors + warnings + info (default for production)
# - debug: All above + debug messages (default for development)
# - trace: All above + SQL queries (most verbose)
LOG_LEVEL="debug"

# File Upload
MAX_FILE_SIZE="10485760"

# Storage Configuration
# Provider: 's3' for MinIO/AWS S3, 'local' for filesystem
STORAGE_PROVIDER="s3"
STORAGE_LOCAL_PATH="./uploads"

# S3/MinIO Configuration (when STORAGE_PROVIDER=s3)
S3_ENDPOINT="http://localhost:9000"
S3_REGION="us-east-1"
S3_BUCKET="oakcloud"
S3_ACCESS_KEY="oakcloud"
S3_SECRET_KEY="oakcloud_minio_secret"
S3_FORCE_PATH_STYLE="true"
S3_USE_SSL="false"

# S3 Server-Side Encryption (AES256 | aws:kms | none)
# - AES256: SSE-S3 (default, recommended) - Amazon S3 managed keys
# - aws:kms: SSE-KMS - AWS Key Management Service (requires S3_KMS_KEY_ID)
# - none: No server-side encryption (not recommended for production)
S3_ENCRYPTION="AES256"
# S3_KMS_KEY_ID="arn:aws:kms:region:account:key/key-id"  # Required when S3_ENCRYPTION=aws:kms

# Email Configuration
# Required for sending emails (password reset, user invitations, notifications)
# If not configured, emails will be logged to console in development mode
#
# Supports two providers (Microsoft Graph is preferred if both are configured):
# 1. Microsoft Graph API (recommended for Microsoft 365 users)
# 2. SMTP (fallback for other providers)

# --- Option 1: Microsoft Graph API (Recommended for M365) ---
# Register an app in Azure AD: https://portal.azure.com â†’ App registrations
# Grant "Mail.Send" application permission and admin consent
AZURE_TENANT_ID="your-azure-tenant-id"
AZURE_CLIENT_ID="your-azure-client-id"
AZURE_CLIENT_SECRET="your-azure-client-secret"
EMAIL_FROM_ADDRESS="admin@yourdomain.com"
EMAIL_FROM_NAME="Oakcloud"

# --- Option 2: SMTP (Fallback) ---
# Only used if Microsoft Graph is not configured
# SMTP_HOST="smtp.example.com"
# SMTP_PORT="587"
# SMTP_SECURE="false"
# SMTP_USER="your-smtp-username"
# SMTP_PASSWORD="your-smtp-password"
# EMAIL_FROM_ADDRESS="noreply@example.com"
# EMAIL_FROM_NAME="Oakcloud"

# Common SMTP Provider Examples:
#
# Gmail (requires App Password if 2FA enabled):
# SMTP_HOST="smtp.gmail.com"
# SMTP_PORT="587"
# SMTP_USER="your-email@gmail.com"
# SMTP_PASSWORD="your-app-password"
#
# Amazon SES:
# SMTP_HOST="email-smtp.us-east-1.amazonaws.com"
# SMTP_PORT="587"
# SMTP_USER="your-ses-smtp-user"
# SMTP_PASSWORD="your-ses-smtp-password"
#
# SendGrid:
# SMTP_HOST="smtp.sendgrid.net"
# SMTP_PORT="587"
# SMTP_USER="apikey"
# SMTP_PASSWORD="your-sendgrid-api-key"

# Encryption Key (required for encrypting sensitive data like API keys)
# Must be at least 32 characters. Generate with: openssl rand -hex 32
ENCRYPTION_KEY="your-32-character-or-longer-encryption-key-here"

# =============================================================================
# TASK SCHEDULER CONFIGURATION
# =============================================================================
# The general-purpose scheduler runs periodic tasks automatically.
# No external cron job needed - tasks run within the application!

# Master switch: Set to "true" to enable the task scheduler
SCHEDULER_ENABLED="true"

# --- Backup Task ---
# Checks for due backup schedules and processes them
SCHEDULER_BACKUP_ENABLED="true"
# How often to check for due backups (default: every 15 minutes)
SCHEDULER_BACKUP_CRON="0,15,30,45 * * * *"

# --- Cleanup Task ---
# Cleans up expired backups and marks stale in-progress backups as failed
SCHEDULER_CLEANUP_ENABLED="true"
# When to run cleanup (default: daily at 2 AM)
SCHEDULER_CLEANUP_CRON="0 2 * * *"

# --- Default Backup Settings ---
# These are the defaults when creating a new backup schedule for a tenant
# BACKUP_DEFAULT_RETENTION_DAYS: How long to keep backups (1-365)
BACKUP_DEFAULT_RETENTION_DAYS="30"
# BACKUP_DEFAULT_MAX_BACKUPS: Maximum scheduled backups to keep per tenant (1-100)
BACKUP_DEFAULT_MAX_BACKUPS="10"

# --- Stale Backup Handling ---
# Backups stuck in progress for longer than this are marked as failed
BACKUP_STALE_THRESHOLD_MINUTES="60"

# --- Optional: External Cron Authentication ---
# If you prefer to trigger backups via external cron service instead of the built-in scheduler,
# set SCHEDULER_ENABLED="false" and configure CRON_SECRET
# Generate with: openssl rand -hex 32
# CRON_SECRET="your-cron-secret-here"

# =============================================================================
# PRODUCTION CONFIGURATION
# =============================================================================
# When deploying to production, ensure the following:
#
# 1. Security Settings:
#    NODE_ENV="production"
#    JWT_SECRET="<long-random-string>"          # Generate: openssl rand -base64 48
#    ENCRYPTION_KEY="<32-char-hex-string>"      # Generate: openssl rand -hex 32
#
# 2. S3 Storage with SSL & Encryption:
#    S3_ENDPOINT="https://s3.amazonaws.com"     # Use HTTPS
#    S3_USE_SSL="true"
#    S3_ENCRYPTION="AES256"                     # Enable server-side encryption
#    S3_FORCE_PATH_STYLE="false"                # Use virtual-hosted style for AWS
#
# 3. Database with SSL:
#    DATABASE_URL="postgresql://...?sslmode=require"
#
# 4. Cookie Security:
#    Cookies are automatically set to secure=true when NODE_ENV=production
#
# 5. Password Hashing:
#    Uses Argon2id (OWASP recommended) with automatic bcrypt migration
